<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="Doc.css" />
    <link
      rel="icon"
      href="https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg"
      type="image/x-icon"
    />
    <title>Lista 1</title>
  </head>
  <body>
    <header>
      <nav id="navbar">
        <ul>
          <li class="nav-link"><a href="#questao_1">Questão 1</a></li>
        </ul>
      </nav>
    </header>
<section id="questao_1">
      <h1>Questão 1</h1>
      <h2>Implementação em C#</h2>
      <pre><code>
            using System;
using System.Windows.Forms;
using System.Windows.Forms.DataVisualization.Charting;
using System.Collections.Generic;

class InterpolacaoLagrange : Form
{
    static double[] x = { 0, 0.5, 1, 1.5, 2, 2.5, 3 };
    static double[] y = { 1.8421, 2.4694, 2.4921, 1.9047, 0.8509, -0.4112, -1.5727 };

    [STAThread]
    static void Main()
    {
        Application.Run(new InterpolacaoLagrange());
    }

    public InterpolacaoLagrange()
    {
        this.Text = "Interpolação de Lagrange - Raiz";
        this.Width = 800;
        this.Height = 600;

        var chart = new Chart();
        chart.Dock = DockStyle.Fill;
        this.Controls.Add(chart);

        var chartArea = new ChartArea();
        chart.ChartAreas.Add(chartArea);

        var series = new Series
        {
            ChartType = SeriesChartType.Line,
            BorderWidth = 2,
            Color = System.Drawing.Color.Blue
        };

        // (a) Interpolação com 3 pontos: x = 1.5, 2, 2.5
        double[] x3 = { 1.5, 2, 2.5 };
        double[] y3 = { 1.9047, 0.8509, -0.4112 };

        // Plotar o polinômio de Lagrange com 3 pontos
        for (double xi = 1.5; xi <= 2.5; xi += 0.01)
        {
            series.Points.AddXY(xi, Lagrange(x3, y3, xi));
        }

        chart.Series.Add(series);

        var pontos = new Series
        {
            ChartType = SeriesChartType.Point,
            MarkerSize = 7,
            MarkerStyle = MarkerStyle.Circle,
            Color = System.Drawing.Color.Red
        };

        for (int i = 0; i < x.Length; i++)
            pontos.Points.AddXY(x[i], y[i]);

        chart.Series.Add(pontos);

        // Buscar raiz usando interpolação de 3 pontos
        double raiz = EncontrarRaiz(x3, y3, 1.5, 2.5, 1e-5);
        MessageBox.Show($"Raiz estimada (3 pontos): x ≈ {raiz:F5}\n y(x) ≈ {Lagrange(x3, y3, raiz):F5}");
    }

    static double Lagrange(double[] x, double[] y, double xi)
    {
        double sum = 0;
        for (int i = 0; i < x.Length; i++)
        {
            double term = y[i];
            for (int j = 0; j < x.Length; j++)
            {
                if (j != i)
                    term *= (xi - x[j]) / (x[i] - x[j]);
            }
            sum += term;
        }
        return sum;
    }

    static double EncontrarRaiz(double[] x, double[] y, double a, double b, double tol)
    {
        double fa = Lagrange(x, y, a);
        double fb = Lagrange(x, y, b);

        if (fa * fb > 0)
            throw new Exception("A função não muda de sinal no intervalo dado.");

        while ((b - a) > tol)
        {
            double c = (a + b) / 2;
            double fc = Lagrange(x, y, c);
            if (fa * fc < 0)
            {
                b = c;
                fb = fc;
            }
            else
            {
                a = c;
                fa = fc;
            }
        }
        return (a + b) / 2;
    }
}
        
        </code></pre>
      <pre>
        Saída:
            Resolvendo pelo Método de Cramer:
                x1 = 1,00
                x2 = -1,00
                x3 = 3,00

                Resolvendo pela Eliminação de Gauss:
                x1 = 1,00
                x2 = -1,00
                x3 = 3,00

                Resolvendo pela Decomposição LU:
                x1 = 1,00
                x2 = -1,00
                x3 = 3,00
        </pre
      >
    </section>
            </body>
